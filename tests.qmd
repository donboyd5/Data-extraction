---
format:
  html:
    toc: true
    toc-depth: 4
    page-layout: full
    css: wider.css
---    


```{r}
#| label: libraries

source(here::here("setup.R"))

plan <- "frs"

xddir <- fs::path(HH, "plans", plan)
extracted_data <- paste0(plan, "_extracted_data.xlsm")
xdpath <- fs::path(xddir, extracted_data)
sheets <- readxl::excel_sheets(xdpath)

```

## Tests

### Benefit-multiplier determination

```{r}
#| label: tests
#| echo: true

# Source benefit-multiplier functions
source(here::here("plans", plan, "benefit-functions.R"))
source(here::here("plans", plan, "lookup-functions.R"))

# load lookup table and test data
benefit_rules <- read_excel(xdpath, sheet = "benefit_rules", range = "D9:P98")
test_cases <- read_excel(xdpath, sheet = "benefit_rules_test", range = "D6:L56")

# run one or more benefit-multiplier tests

testthat::test_file("tests/testthat/test-benefit-multiplier.R") # run all tests in the file

# run a single test
testthat::test_file(
  "tests/testthat/test-benefit-multiplier.R",
  desc = "benmult_function and benmult_lookup agree"
)

# testthat::test_dir("tests/testthat") # Run all tests in directory


```
